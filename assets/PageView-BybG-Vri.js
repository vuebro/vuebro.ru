import{defineComponent as P,ref as S,computed as l,watch as B,onUnmounted as O,createElementBlock as x,openBlock as d,Fragment as j,renderList as R,normalizeClass as $,createBlock as E,Suspense as z,withCtx as D,resolveDynamicComponent as F}from"vue";import{t as i,u as V,p as w,m as L,a as T,b as U,r as X,c as Y,d as q,s as A,e as G,_ as H}from"./index-By42K9ES.js";import{useRoute as I,useRouter as J}from"vue-router";import"./sucrase-Cw4LZf8f.js";import"./compiler-sfc-CHbDt8t7.js";const K=P({__name:"PageView",setup(y,{expose:b}){b();const f=S([]),o=I(),p=J(),m=l(()=>i.value?.siblings??[]),e=[],v=l(()=>m.value.filter(({enabled:t})=>t)),_=()=>{e.forEach(t=>{t()}),e.length=0},u=l(()=>i.value===void 0||i.value.parent?.flat?v.value:[i.value]),n=l(()=>new Map(u.value.map(({id:t=V()})=>[t,!1]))),h=S(new Map(n.value)),C=l(()=>{const[[t,s]=[]]=w;return w.clear(),t&&s&&w.set(t,s),Object.fromEntries(u.value.map(r=>[r.id,L(r)]))});B(f,t=>{_(),setTimeout(()=>{t.forEach(s=>{const{stop:r}=T(s,([{isIntersecting:a,target:{id:c}={}}={}]=[])=>{h.value=new Map(n.value),c&&a!==void 0&&n.value.set(c,a)},{threshold:.1});e.push(r)})})},{deep:!0}),U(window,{behavior:"smooth",onStop:()=>{if(!Y.value){const{scrollX:t,scrollY:s}=window,[r]=u.value,[a]=q.value;if(a&&r){const{$children:[{id:c}={}]=[]}=a,M=!Math.floor(t)&&!Math.floor(s)&&r.id===c?a.id:[...n.value.entries()].find(([,g])=>g)?.[0]??[...h.value.entries()].find(([,g])=>g)?.[0]??r.id;M!==o.name&&(A.value=!1,p.push({name:M}).catch(G))}}}}),O(_);const k={refs:f,route:o,router:p,siblings:m,stops:e,$siblings:v,clearStops:_,these:u,intersecting:n,$intersecting:h,templates:C,get uid(){return V},get resolve(){return X},get that(){return i}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),N=["id","role"];function Q(y,b,f,o,p,m){return d(!0),x(j,null,R(o.these,e=>(d(),x("div",{id:e.id??o.uid(),key:e.id??o.uid(),ref_for:!0,ref:"refs",class:$(e.class),role:e.id===o.that?.id?"main":"section","un-cloak":""},[(d(),E(z,null,{default:D(()=>[(d(),E(F(o.templates[e.id]),{id:e.id,"un-cloak":"",onVnodeMounted:v=>o.resolve(e)},null,8,["id","onVnodeMounted"]))]),_:2},1024))],10,N))),128)}const re=H(K,[["render",Q],["__file","PageView.vue"]]);export{re as default};
