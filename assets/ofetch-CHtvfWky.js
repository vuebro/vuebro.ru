import{d as g}from"./destr-CVtkxrq9.js";import{w as T,a as q}from"./ufo-CsG24Xhf.js";class E extends Error{constructor(s,r){super(s,r),this.name="FetchError",r?.cause&&!this.cause&&(this.cause=r.cause)}}function S(o){const s=o.error?.message||o.error?.toString()||"",r=o.request?.method||o.options?.method||"GET",i=o.request?.url||String(o.request)||"/",f=`[${r}] ${JSON.stringify(i)}`,p=o.response?`${o.response.status} ${o.response.statusText}`:"<no response>",c=`${f}: ${p}${s?` ${s}`:""}`,t=new E(c,o.error?{cause:o.error}:void 0);for(const n of["request","options","response"])Object.defineProperty(t,n,{get(){return o[n]}});for(const[n,u]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(t,n,{get(){return o.response&&o.response[u]}});return t}const R=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function l(o="GET"){return R.has(o.toUpperCase())}function $(o){if(o===void 0)return!1;const s=typeof o;return s==="string"||s==="number"||s==="boolean"||s===null?!0:s!=="object"?!1:Array.isArray(o)?!0:o.buffer?!1:o.constructor&&o.constructor.name==="Object"||typeof o.toJSON=="function"}const j=new Set(["image/svg","application/xml","application/xhtml","application/html"]),A=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function C(o=""){if(!o)return"json";const s=o.split(";").shift()||"";return A.test(s)?"json":j.has(s)||s.startsWith("text/")?"text":"blob"}function O(o,s,r=globalThis.Headers){const i={...s,...o};if(s?.params&&o?.params&&(i.params={...s?.params,...o?.params}),s?.query&&o?.query&&(i.query={...s?.query,...o?.query}),s?.headers&&o?.headers){i.headers=new r(s?.headers||{});for(const[f,p]of new r(o?.headers||{}))i.headers.set(f,p)}return i}const P=new Set([408,409,425,429,500,502,503,504]),k=new Set([101,204,205,304]);function b(o={}){const{fetch:s=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:i=globalThis.AbortController}=o;async function f(t){const n=t.error&&t.error.name==="AbortError"&&!t.options.timeout||!1;if(t.options.retry!==!1&&!n){let e;typeof t.options.retry=="number"?e=t.options.retry:e=l(t.options.method)?0:1;const d=t.response&&t.response.status||500;if(e>0&&(Array.isArray(t.options.retryStatusCodes)?t.options.retryStatusCodes.includes(d):P.has(d))){const h=t.options.retryDelay||0;return h>0&&await new Promise(a=>setTimeout(a,h)),p(t.request,{...t.options,retry:e-1})}}const u=S(t);throw Error.captureStackTrace&&Error.captureStackTrace(u,p),u}const p=async function(n,u={}){const e={request:n,options:O(u,o.defaults,r),response:void 0,error:void 0};e.options.method=e.options.method?.toUpperCase(),e.options.onRequest&&await e.options.onRequest(e),typeof e.request=="string"&&(e.options.baseURL&&(e.request=T(e.request,e.options.baseURL)),(e.options.query||e.options.params)&&(e.request=q(e.request,{...e.options.params,...e.options.query}))),e.options.body&&l(e.options.method)&&($(e.options.body)?(e.options.body=typeof e.options.body=="string"?e.options.body:JSON.stringify(e.options.body),e.options.headers=new r(e.options.headers||{}),e.options.headers.has("content-type")||e.options.headers.set("content-type","application/json"),e.options.headers.has("accept")||e.options.headers.set("accept","application/json")):("pipeTo"in e.options.body&&typeof e.options.body.pipeTo=="function"||typeof e.options.body.pipe=="function")&&("duplex"in e.options||(e.options.duplex="half")));let d;if(!e.options.signal&&e.options.timeout){const a=new i;d=setTimeout(()=>a.abort(),e.options.timeout),e.options.signal=a.signal}try{e.response=await s(e.request,e.options)}catch(a){return e.error=a,e.options.onRequestError&&await e.options.onRequestError(e),await f(e)}finally{d&&clearTimeout(d)}if(e.response.body&&!k.has(e.response.status)&&e.options.method!=="HEAD"){const a=(e.options.parseResponse?"json":e.options.responseType)||C(e.response.headers.get("content-type")||"");switch(a){case"json":{const m=await e.response.text(),w=e.options.parseResponse||g;e.response._data=w(m);break}case"stream":{e.response._data=e.response.body;break}default:e.response._data=await e.response[a]()}}return e.options.onResponse&&await e.options.onResponse(e),!e.options.ignoreResponseError&&e.response.status>=400&&e.response.status<600?(e.options.onResponseError&&await e.options.onResponseError(e),await f(e)):e.response},c=async function(n,u){return(await p(n,u))._data};return c.raw=p,c.native=(...t)=>s(...t),c.create=(t={})=>b({...o,defaults:{...o.defaults,...t}}),c}const y=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),F=y.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),H=y.Headers,_=y.AbortController,J=b({fetch:F,Headers:H,AbortController:_}),B=J;export{B as $fetch,_ as AbortController,E as FetchError,H as Headers,b as createFetch,S as createFetchError,F as fetch,J as ofetch};
