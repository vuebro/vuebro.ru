import{defineComponent as L,ref as d,computed as f,watch as $,nextTick as g,onUnmounted as x,onMounted as C,openBlock as v,createElementBlock as V,Fragment as U,renderList as X,normalizeClass as Y,createBlock as q,resolveDynamicComponent as G}from"vue";import{a as E,b as O}from"./vueuse-Bs6x0GOr.js";import{$ as s,g as B,d as j,b as A,a as P,p as R,r as H,s as T,t as z,_ as J}from"./index-B5xG1iae.js";import{b as F}from"./vue-router-DgSFFxGk.js";import"./unocss-BkcBwv3F.js";import"./ofetch-CwKPICM-.js";import"./destr-CVtkxrq9.js";import"./ufo-CsG24Xhf.js";import"./magic-string-CTxECtaK.js";import"./jridgewell-CS0TOL6_.js";import"./ajv-DVT_ztRr.js";import"./fast-deep-equal-DhA4GXGS.js";import"./json-schema-traverse-DW8_mBst.js";import"./fast-uri-DiSllsZr.js";import"./ajv-keywords-fgJOexQU.js";import"./uuid-random-C5LgB_p5.js";import"./iconify-DZNnka9g.js";import"./unhead-12oOAFTY.js";import"./hookable-B8xFkYCm.js";import"./vue3-sfc-loader-CoUr1SK8.js";import"./vue-Cow_pXkh.js";const K=L({__name:"MultiView",setup(I,{expose:_}){_();const c=d([]),r=F(),u=f(()=>Object.fromEntries(s.value.map(e=>[e.id,B(e)]))),w=({id:e})=>u.value[e],o=f(()=>new Map(s.value.map(({id:e})=>[e,!1]))),n=d(new Map(o.value)),h=()=>{var e,t;if(console.log("onStop"),!R.value&&z.value&&s.value.length){const{scrollX:a,scrollY:k}=window,[i]=s.value,{root:S}=i,{$children:[{id:y}]=[{}]}=S,D=!Math.floor(a)&&!Math.floor(k)&&i.id===y?S.id:((e=[...o.value.entries()].find(([,m])=>m))==null?void 0:e[0])??((t=[...n.value.entries()].find(([,m])=>m))==null?void 0:t[0])??i.id;console.log(!Math.floor(a)&&!Math.floor(k)&&i.id===y,{name:D}),T.value=!1,r.push({name:D}).catch(()=>{})}};E(window,{behavior:A,onStop:h});const b=([{isIntersecting:e,target:{id:t}}])=>{console.log({id:t,isIntersecting:e}),n.value=new Map(o.value),o.value.set(t,e)},l=[],p=()=>{l.forEach(e=>{e()}),l.length=0};$(c,async e=>{p(),console.log(1,Date.now()),await g(),console.log(2,Date.now()),await new Promise(t=>{setTimeout(t)}),console.log(3,Date.now()),await g(),console.log(4,Date.now()),e.forEach(t=>{const{stop:a}=O(t,b,{threshold:P});l.push(a)})},{deep:j}),x(()=>{p()}),C(()=>{console.log("onMounted",Date.now())});const M={refs:c,router:r,templates:u,template:w,intersecting:o,$intersecting:n,onStop:h,callback:b,stops:l,clearStops:p,get useIntersectionObserver(){return O},get useScroll(){return E},get behavior(){return A},get deep(){return j},get threshold(){return P},computed:f,nextTick:g,onMounted:C,onUnmounted:x,ref:d,watch:$,get useRouter(){return F},get $siblings(){return s},get getAsyncComponent(){return B},get paused(){return R},get resolve(){return H},get scroll(){return T},get that(){return z}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),N=["id","role"];function Q(I,_,c,r,u,w){return v(!0),V(U,null,X(r.$siblings,o=>{var n;return v(),V("div",{class:Y(o.class),id:o.id,key:o.id,role:o.id===((n=r.that)==null?void 0:n.id)?"main":void 0,ref_for:!0,ref:"refs","un-cloak":""},[(v(),q(G(r.template(o)),{id:o.id,onVnodeMounted:()=>{console.log("resolve",o),r.resolve(o)}},null,8,["id","onVnodeMounted"]))],10,N)}),128)}const he=J(K,[["render",Q],["__file","MultiView.vue"]]);export{he as default};
