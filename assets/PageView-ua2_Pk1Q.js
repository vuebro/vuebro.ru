import{defineComponent as P,ref as E,computed as i,watch as B,onUnmounted as C,createElementBlock as S,openBlock as g,Fragment as O,renderList as j,normalizeClass as R,createBlock as $,resolveDynamicComponent as z}from"vue";import{t as l,u as V,p as w,m as D,a as F,b as L,r as T,c as U,d as X,s as Y,e as q,_ as A}from"./index-DGwj3ENK.js";import{useRoute as G,useRouter as H}from"vue-router";import"./sucrase-Cw4LZf8f.js";import"./compiler-sfc-4yqCFQUb.js";const I=P({__name:"PageView",setup(x,{expose:b}){b();const d=E([]),t=G(),f=H(),p=i(()=>l.value?.siblings??[]),e=[],m=i(()=>p.value.filter(({enabled:o})=>o)),v=()=>{e.forEach(o=>{o()}),e.length=0},u=i(()=>l.value===void 0||l.value.parent?.flat?m.value:[l.value]),n=i(()=>new Map(u.value.map(({id:o=V()})=>[o,!1]))),_=E(new Map(n.value)),y=i(()=>{const[[o,s]=[]]=w;return w.clear(),o&&s&&w.set(o,s),Object.fromEntries(u.value.map(r=>[r.id,D(r)]))});B(d,o=>{v(),setTimeout(()=>{o.forEach(s=>{const{stop:r}=F(s,([{isIntersecting:a,target:{id:c}={}}={}]=[])=>{_.value=new Map(n.value),c&&a!==void 0&&n.value.set(c,a)},{threshold:.1});e.push(r)})})},{deep:!0}),L(window,{behavior:"smooth",onStop:()=>{if(!U.value){const{scrollX:o,scrollY:s}=window,[r]=u.value,[a]=X.value;if(a&&r){const{$children:[{id:c}={}]=[]}=a,M=!Math.floor(o)&&!Math.floor(s)&&r.id===c?a.id:[...n.value.entries()].find(([,h])=>h)?.[0]??[..._.value.entries()].find(([,h])=>h)?.[0]??r.id;M!==t.name&&(Y.value=!1,f.push({name:M}).catch(q))}}}}),C(v);const k={refs:d,route:t,router:f,siblings:p,stops:e,$siblings:m,clearStops:v,these:u,intersecting:n,$intersecting:_,templates:y,get uid(){return V},get resolve(){return T},get that(){return l}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),J=["id","role"];function K(x,b,d,t,f,p){return g(!0),S(O,null,j(t.these,e=>(g(),S("div",{id:e.id??t.uid(),key:e.id??t.uid(),ref_for:!0,ref:"refs",class:R(e.class),role:e.id===t.that?.id?"main":"section","un-cloak":""},[(g(),$(z(t.templates[e.id]),{id:e.id,"un-cloak":"",onVnodeMounted:m=>t.resolve(e)},null,8,["id","onVnodeMounted"]))],10,J))),128)}const oe=A(I,[["render",K],["__file","PageView.vue"]]);export{oe as default};
