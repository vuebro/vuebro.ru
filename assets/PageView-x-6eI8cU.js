import{defineComponent as B,ref as M,computed as u,watch as C,onUnmounted as O,createElementBlock as E,openBlock as g,Fragment as j,renderList as $,normalizeClass as z,createBlock as D,resolveDynamicComponent as F}from"vue";import{t as d,v as S,p as w,m as L,u as R,a as T,r as U,b as X,c as Y,s as q,d as A,_ as G}from"./index-CjgWyjbH.js";import{useRouter as H}from"vue-router";import"./sucrase-DTaNgZ3p.js";import"./compiler-sfc-DUpFnHsr.js";const I=B({__name:"PageView",setup(V,{expose:b}){b();const f=M([]),t=H(),p=u(()=>{var e;return((e=d.value)==null?void 0:e.siblings)??[]}),l=[],o=u(()=>p.value.filter(({enabled:e})=>e)),s=()=>{l.forEach(e=>{e()}),l.length=0},i=u(()=>{var e;return d.value===void 0||(e=d.value.parent)!=null&&e.flat?o.value:[d.value]}),c=u(()=>new Map(i.value.map(({id:e=S()})=>[e,!1]))),m=M(new Map(c.value)),x=u(()=>{const[[e,r]=[]]=w;return w.clear(),e&&r&&w.set(e,r),Object.fromEntries(i.value.map(a=>[a.id,L(a)]))});C(f,e=>{s(),setTimeout(()=>{e.forEach(r=>{const{stop:a}=R(r,([{isIntersecting:v,target:{id:n}={}}={}]=[])=>{m.value=new Map(c.value),n&&v!==void 0&&c.value.set(n,v)},{threshold:.1});l.push(a)})})},{deep:!0}),T(window,{behavior:"smooth",onStop:()=>{var e,r;if(!X.value){const{scrollX:a,scrollY:v}=window,[n]=i.value,[_]=Y.value;if(_&&n){const{$children:[{id:y}={}]=[]}=_,P=!Math.floor(a)&&!Math.floor(v)&&n.id===y?_.id:((e=[...c.value.entries()].find(([,h])=>h))==null?void 0:e[0])??((r=[...m.value.entries()].find(([,h])=>h))==null?void 0:r[0])??n.id;q.value=!1,t.push({name:P}).catch(A)}}}}),O(s);const k={refs:f,router:t,siblings:p,stops:l,$siblings:o,clearStops:s,these:i,intersecting:c,$intersecting:m,templates:x,get v4(){return S},get resolve(){return U},get that(){return d}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),J=["id","role"];function K(V,b,f,t,p,l){return g(!0),E(j,null,$(t.these,o=>{var s;return g(),E("div",{id:o.id??t.v4(),key:o.id??t.v4(),ref_for:!0,ref:"refs",class:z(o.class),role:o.id===((s=t.that)==null?void 0:s.id)?"main":"section","un-cloak":""},[(g(),D(F(t.templates[o.id]),{id:o.id,"un-cloak":"",onVnodeMounted:i=>t.resolve(o)},null,8,["id","onVnodeMounted"]))],10,J)}),128)}const oe=G(I,[["render",K],["__file","PageView.vue"]]);export{oe as default};
