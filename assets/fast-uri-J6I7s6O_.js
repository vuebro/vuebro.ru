var R={exports:{}},k,L;function D(){return L||(L=1,k={HEX:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15}}),k}var x,N;function b(){if(N)return x;N=1;const{HEX:z}=D(),E=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function o(i){if(I(i,".")<3)return{host:i,isIPV4:!1};const s=i.match(E)||[],[t]=s;return t?{host:H(t,"."),isIPV4:!0}:{host:i,isIPV4:!1}}function g(i,s=!1){let t="",e=!0;for(const r of i){if(z[r]===void 0)return;r!=="0"&&e===!0&&(e=!1),e||(t+=r)}return s&&t.length===0&&(t="0"),t}function p(i){let s=0;const t={error:!1,address:"",zone:""},e=[],r=[];let f=!1,u=!1,a=!1;function n(){if(r.length){if(f===!1){const c=g(r);if(c!==void 0)e.push(c);else return t.error=!0,!1}r.length=0}return!0}for(let c=0;c<i.length;c++){const l=i[c];if(!(l==="["||l==="]"))if(l===":"){if(u===!0&&(a=!0),!n())break;if(s++,e.push(":"),s>7){t.error=!0;break}c-1>=0&&i[c-1]===":"&&(u=!0);continue}else if(l==="%"){if(!n())break;f=!0}else{r.push(l);continue}}return r.length&&(f?t.zone=r.join(""):a?e.push(r.join("")):e.push(g(r))),t.address=e.join(""),t}function y(i){if(I(i,":")<2)return{host:i,isIPV6:!1};const s=p(i);if(s.error)return{host:i,isIPV6:!1};{let t=s.address,e=s.address;return s.zone&&(t+="%"+s.zone,e+="%25"+s.zone),{host:t,escapedHost:e,isIPV6:!0}}}function H(i,s){let t="",e=!0;const r=i.length;for(let f=0;f<r;f++){const u=i[f];u==="0"&&e?(f+1<=r&&i[f+1]===s||f+1===r)&&(t+=u,e=!1):(u===s?e=!0:e=!1,t+=u)}return t}function I(i,s){let t=0;for(let e=0;e<i.length;e++)i[e]===s&&t++;return t}const q=/^\.\.?\//u,S=/^\/\.(?:\/|$)/u,h=/^\/\.\.(?:\/|$)/u,P=/^\/?(?:.|\n)*?(?=\/|$)/u;function U(i){const s=[];for(;i.length;)if(i.match(q))i=i.replace(q,"");else if(i.match(S))i=i.replace(S,"/");else if(i.match(h))i=i.replace(h,"/"),s.pop();else if(i==="."||i==="..")i="";else{const t=i.match(P);if(t){const e=t[0];i=i.slice(e.length),s.push(e)}else throw new Error("Unexpected dot segment condition")}return s.join("")}function m(i,s){const t=s!==!0?escape:unescape;return i.scheme!==void 0&&(i.scheme=t(i.scheme)),i.userinfo!==void 0&&(i.userinfo=t(i.userinfo)),i.host!==void 0&&(i.host=t(i.host)),i.path!==void 0&&(i.path=t(i.path)),i.query!==void 0&&(i.query=t(i.query)),i.fragment!==void 0&&(i.fragment=t(i.fragment)),i}function d(i){const s=[];if(i.userinfo!==void 0&&(s.push(i.userinfo),s.push("@")),i.host!==void 0){let t=unescape(i.host);const e=o(t);if(e.isIPV4)t=e.host;else{const r=y(e.host);r.isIPV6===!0?t=`[${r.escapedHost}]`:t=i.host}s.push(t)}return(typeof i.port=="number"||typeof i.port=="string")&&(s.push(":"),s.push(String(i.port))),s.length?s.join(""):void 0}return x={recomposeAuthority:d,normalizeComponentEncoding:m,removeDotSegments:U,normalizeIPv4:o,normalizeIPv6:y,stringArrayToHexStripped:g},x}var $,V;function T(){if(V)return $;V=1;const z=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu,E=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function o(e){return typeof e.secure=="boolean"?e.secure:String(e.scheme).toLowerCase()==="wss"}function g(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function p(e){const r=String(e.scheme).toLowerCase()==="https";return(e.port===(r?443:80)||e.port==="")&&(e.port=void 0),e.path||(e.path="/"),e}function y(e){return e.secure=o(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e}function H(e){if((e.port===(o(e)?443:80)||e.port==="")&&(e.port=void 0),typeof e.secure=="boolean"&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){const[r,f]=e.resourceName.split("?");e.path=r&&r!=="/"?r:void 0,e.query=f,e.resourceName=void 0}return e.fragment=void 0,e}function I(e,r){if(!e.path)return e.error="URN can not be parsed",e;const f=e.path.match(E);if(f){const u=r.scheme||e.scheme||"urn";e.nid=f[1].toLowerCase(),e.nss=f[2];const a=`${u}:${r.nid||e.nid}`,n=t[a];e.path=void 0,n&&(e=n.parse(e,r))}else e.error=e.error||"URN can not be parsed.";return e}function q(e,r){const f=r.scheme||e.scheme||"urn",u=e.nid.toLowerCase(),a=`${f}:${r.nid||u}`,n=t[a];n&&(e=n.serialize(e,r));const c=e,l=e.nss;return c.path=`${u||r.nid}:${l}`,r.skipEscape=!0,c}function S(e,r){const f=e;return f.uuid=f.nss,f.nss=void 0,!r.tolerant&&(!f.uuid||!z.test(f.uuid))&&(f.error=f.error||"UUID is not valid."),f}function h(e){const r=e;return r.nss=(e.uuid||"").toLowerCase(),r}const P={scheme:"http",domainHost:!0,parse:g,serialize:p},U={scheme:"https",domainHost:P.domainHost,parse:g,serialize:p},m={scheme:"ws",domainHost:!0,parse:y,serialize:H},d={scheme:"wss",domainHost:m.domainHost,parse:m.parse,serialize:m.serialize},t={http:P,https:U,ws:m,wss:d,urn:{scheme:"urn",parse:I,serialize:q,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:S,serialize:h,skipNormalize:!0}};return $=t,$}var j;function O(){if(j)return R.exports;j=1;const{normalizeIPv6:z,normalizeIPv4:E,removeDotSegments:o,recomposeAuthority:g,normalizeComponentEncoding:p}=b(),y=T();function H(s,t){return typeof s=="string"?s=h(d(s,t),t):typeof s=="object"&&(s=d(h(s,t),t)),s}function I(s,t,e){const r=Object.assign({scheme:"null"},e),f=q(d(s,r),d(t,r),r,!0);return h(f,{...r,skipEscape:!0})}function q(s,t,e,r){const f={};return r||(s=d(h(s,e),e),t=d(h(t,e),e)),e=e||{},!e.tolerant&&t.scheme?(f.scheme=t.scheme,f.userinfo=t.userinfo,f.host=t.host,f.port=t.port,f.path=o(t.path||""),f.query=t.query):(t.userinfo!==void 0||t.host!==void 0||t.port!==void 0?(f.userinfo=t.userinfo,f.host=t.host,f.port=t.port,f.path=o(t.path||""),f.query=t.query):(t.path?(t.path.charAt(0)==="/"?f.path=o(t.path):((s.userinfo!==void 0||s.host!==void 0||s.port!==void 0)&&!s.path?f.path="/"+t.path:s.path?f.path=s.path.slice(0,s.path.lastIndexOf("/")+1)+t.path:f.path=t.path,f.path=o(f.path)),f.query=t.query):(f.path=s.path,t.query!==void 0?f.query=t.query:f.query=s.query),f.userinfo=s.userinfo,f.host=s.host,f.port=s.port),f.scheme=s.scheme),f.fragment=t.fragment,f}function S(s,t,e){return typeof s=="string"?(s=unescape(s),s=h(p(d(s,e),!0),{...e,skipEscape:!0})):typeof s=="object"&&(s=h(p(s,!0),{...e,skipEscape:!0})),typeof t=="string"?(t=unescape(t),t=h(p(d(t,e),!0),{...e,skipEscape:!0})):typeof t=="object"&&(t=h(p(t,!0),{...e,skipEscape:!0})),s.toLowerCase()===t.toLowerCase()}function h(s,t){const e={host:s.host,scheme:s.scheme,userinfo:s.userinfo,port:s.port,path:s.path,query:s.query,nid:s.nid,nss:s.nss,uuid:s.uuid,fragment:s.fragment,reference:s.reference,resourceName:s.resourceName,secure:s.secure,error:""},r=Object.assign({},t),f=[],u=y[(r.scheme||e.scheme||"").toLowerCase()];u&&u.serialize&&u.serialize(e,r),e.path!==void 0&&(r.skipEscape?e.path=unescape(e.path):(e.path=escape(e.path),e.scheme!==void 0&&(e.path=e.path.split("%3A").join(":")))),r.reference!=="suffix"&&e.scheme&&f.push(e.scheme,":");const a=g(e);if(a!==void 0&&(r.reference!=="suffix"&&f.push("//"),f.push(a),e.path&&e.path.charAt(0)!=="/"&&f.push("/")),e.path!==void 0){let n=e.path;!r.absolutePath&&(!u||!u.absolutePath)&&(n=o(n)),a===void 0&&(n=n.replace(/^\/\//u,"/%2F")),f.push(n)}return e.query!==void 0&&f.push("?",e.query),e.fragment!==void 0&&f.push("#",e.fragment),f.join("")}const P=Array.from({length:127},(s,t)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(t)));function U(s){let t=0;for(let e=0,r=s.length;e<r;++e)if(t=s.charCodeAt(e),t>126||P[t])return!0;return!1}const m=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function d(s,t){const e=Object.assign({},t),r={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},f=s.indexOf("%")!==-1;let u=!1;e.reference==="suffix"&&(s=(e.scheme?e.scheme+":":"")+"//"+s);const a=s.match(m);if(a){if(r.scheme=a[1],r.userinfo=a[3],r.host=a[4],r.port=parseInt(a[5],10),r.path=a[6]||"",r.query=a[7],r.fragment=a[8],isNaN(r.port)&&(r.port=a[5]),r.host){const c=E(r.host);if(c.isIPV4===!1){const l=z(c.host);r.host=l.host.toLowerCase(),u=l.isIPV6}else r.host=c.host,u=!0}r.scheme===void 0&&r.userinfo===void 0&&r.host===void 0&&r.port===void 0&&r.query===void 0&&!r.path?r.reference="same-document":r.scheme===void 0?r.reference="relative":r.fragment===void 0?r.reference="absolute":r.reference="uri",e.reference&&e.reference!=="suffix"&&e.reference!==r.reference&&(r.error=r.error||"URI is not a "+e.reference+" reference.");const n=y[(e.scheme||r.scheme||"").toLowerCase()];if(!e.unicodeSupport&&(!n||!n.unicodeSupport)&&r.host&&(e.domainHost||n&&n.domainHost)&&u===!1&&U(r.host))try{r.host=URL.domainToASCII(r.host.toLowerCase())}catch(c){r.error=r.error||"Host's domain name can not be converted to ASCII: "+c}(!n||n&&!n.skipNormalize)&&(f&&r.scheme!==void 0&&(r.scheme=unescape(r.scheme)),f&&r.host!==void 0&&(r.host=unescape(r.host)),r.path&&(r.path=escape(unescape(r.path))),r.fragment&&(r.fragment=encodeURI(decodeURIComponent(r.fragment)))),n&&n.parse&&n.parse(r,e)}else r.error=r.error||"URI can not be parsed.";return r}const i={SCHEMES:y,normalize:H,resolve:I,resolveComponents:q,equal:S,serialize:h,parse:d};return R.exports=i,R.exports.default=i,R.exports.fastUri=i,R.exports}export{O as r};
